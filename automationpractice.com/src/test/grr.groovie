 import groovy.json.*  testRunner.runTestStepByName("Get shopping cart") def sc = new JsonSlurper().parseText(context.testCase.testSteps["Get shopping cart"].getPropertyValue("Response")) def pooi  sc.items.item 	.findAll{it.product.productCharacteristics 		.findAll{it.name == "contractId" && (it.value == context.expand("\${TestData#contractID}") || it.value == null)}} 	.each{p-> 	 		def poCode = p.productOffering.id 		context.testCase.testSteps["TestData"].setPropertyValue("poCode", poCode)  		log.info "POCode: " + poCode 		 		testRunner.runTestStepByName("Get PO") 	 		def po = new JsonSlurper().parseText(context.testCase.testSteps["Get PO"].getPropertyValue("Response"))[0] 		 		po.versions[0].characteristics.versions.each{ 			if (it[0].id == "productTechnicalType" && it[0].value == "BASIC") 			{ 				pooi = p 				context.testCase.testSteps["TestData"].setPropertyValue("pooiID", pooi.id)  			} 		}  	}  if (pooi == null) { 	log.error "No CBiO Basic PO found in SC!" }   pooi.resources.each{ 	it.resourceCharacteristics.each{ 		if(it.name == "serialNumber") 		{ 			it.value = context.testCase.testSteps["TestData"].getPropertyValue("serialNumber") 		} 		else if(it.name == "resourceNumber") 		{ 			it.value = context.testCase.testSteps["TestData"].getPropertyValue("MSISDN") 		} 		else if(it.name == "SDP_ID") 		{ 			it.value = context.testCase.testSteps["TestData"].getPropertyValue("SDP_ID") 		} 		else if(it.name == "numberingPlan") 		{ 			it.value = context.testCase.testSteps["TestData"].getPropertyValue("numberingPlan") 		} 	} }  def json = new JsonBuilder(pooi)  def putPOOI = json.toPrettyString()  context.testCase.testSteps["Update Basic PO POOI"].setPropertyValue("Request", putPOOI)    /* import groovy.json.*  def response = context.expand('${Create Contract with Basic PO#Response}')  def pooi = new JsonSlurper().parseText(response)  context.testCase.testSteps["TestData"].setPropertyValue("pooiID", pooi.id)  pooi.resources.each{ 	it.resourceCharacteristics.each{ 		if(it.name == "serialNumber") 		{ 			it.value = context.testCase.testSteps["TestData"].getPropertyValue("serialNumber") 		} 		else if(it.name == "resourceNumber") 		{ 			it.value = context.testCase.testSteps["TestData"].getPropertyValue("MSISDN") 		} 		else if(it.name == "SDP_ID") 		{ 			it.value = context.testCase.testSteps["TestData"].getPropertyValue("SDP_ID") 		} 		else if(it.name == "numberingPlan") 		{ 			it.value = context.testCase.testSteps["TestData"].getPropertyValue("numberingPlan") 		} 		 	} }  def json = new JsonBuilder(pooi)  def putPOOI = json.toString()  context.testCase.testSteps["TestData"].setPropertyValue("POOI", putPOOI)  */